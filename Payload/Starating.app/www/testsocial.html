<!DOCTYPE html>

<html>
  <head>
      <meta charset="utf-8" />
      <meta name="format-detection" content="telephone=no" />
      <meta name="msapplication-tap-highlight" content="no" />
      <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
      <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height " />
      <link rel="stylesheet" type="text/css" href="css/index.css" />
      <title>Register</title>
      <script type="text/javascript" src="cordova.js"></script>
      <script src="js/lib/require.js"></script>
      <script src="js/config.js"></script>
      <script type="text/javascript" charset="utf-8">

            // Wait for device API libraries to load
            //
            function onLoad() {
                document.addEventListener("deviceready", onDeviceReady, false);
            }

            // device APIs are available
            //
            function onDeviceReady() {
                // Now safe to use device APIs
                navigator.splashscreen.hide();
                // window.cache.clear( function(s){alert('cleared cache');}, function(s){console.log("error clearing cache"); alert('error clearing cache');} );
            }
      </script>
      <script type="text/javascript">
            require(['jquery','hello'], function ($, hello) {
              
                var socailProvider = '';

                hello.init({
                    google : '656984324806-sr0q9vq78tlna4hvhlmcgp2bs2ut8uj8.apps.googleusercontent.com',
                    facebook : '958239604218546',
                    windows : '00000000400D8578',
                    twitter: 'El2QwNPWW8fwsr603jBv2crxF'
                }, {
                  redirect_uri : document.URL
                  // redirect_uri : 'http://162.13.45.102/starating/StaRatingAPI/public/social/redirect'
                  // redirect_uri : 'http://adodson.com/hello.js/redirect.html'
                });

                function loginHandler(r){
                  //  log(r);
                  console.log("loginHandler");
                  console.log(r);
                    hello(r.network).api('me').on('complete', log);
                }

                function log(r){
                    console.log('this is r' + JSON.stringify(r));
                    r.network = socailProvider;
                    user.socialLogin(r);
                }

                $('#fb').on('click', function(){
                  socailProvider = 'facebook';
                  localStorage.setItem("network", socailProvider);
                  hello('facebook').login({scope:'email, user_birthday'}, loginHandler);
                });

                $('#tw').on('click', function(){
                  socailProvider = 'twitter';
                  localStorage.setItem("network", socailProvider);
                  // hello('twitter').login(loginHandler);
                  // hello('twitter').logout();
                  console.log("before login tw");
                  hello('twitter').login(loginHandler);
                  // hello('twitter').login().then(function(r) { console.log("after login tw"); loginHandler(r);});
                });

                // $('.inner-content').fadeIn();
                $('.content').show();
                $('.header').show();
                $('.under-header').show();

            });
        </script>
  </head>
  <body onload="onLoad()">
    <div class="header" style="display:none;">
        <h2 class="header-title"><span class="header-title-dash">&mdash;</span> Sign up <span class="header-title-dash">&mdash;</span></h2>
    </div>
    <div class="under-header" style="display:none;"></div>
    <div class="content" style="display:none;">
      <div class="inner-content">
        <h1 class="signup-title">Welcome to the fold</h1>
        <h2 class="signup-subtitle">Sign up using any of the following</h2>
        <div class="dash-divider"></div>
        <div class="dash-divider-padding"></div>
        <div class="short-button fb" id='fb'>Facebook</div>
        <div class="short-button tw" id='tw'>Twitter</div>
        <a class="short-button" href='register.html'>Email</a>
        <div class="dash-divider-padding"></div>
        <div class="signup-bottom">
          <div class="dash-divider"></div>
        
          <h2 class="signup-subtitle2">Already a StaRater?</h2>
          <a class="text-button text-button-bottom" href='loginwith.html'>log in here</a>
        </div>
        <div id='fb-root'></div>
      </div>
    </div>
  </body>
</html>
